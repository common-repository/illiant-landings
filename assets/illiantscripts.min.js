!function n(o,a,i){function s(t,e){if(!a[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=a[t]={exports:{}},o[t][0].call(r.exports,function(e){return s(o[t][1][e]||e)},r,r.exports,n,o,a,i)}return a[t].exports}for(var c="function"==typeof require&&require,e=0;e<i.length;e++)s(i[e]);return s}({1:[function(e,t,r){"use strict";var n=e("./utils/constants.js"),o=e("./state/checkKeys.js"),a=e("./modules/extractFigma.js"),i=e("./modules/websockets.js"),s=e("./modules/handleFigmaStyles.js"),c=e("./modules/exportFigmaImages.js"),l=e("./modules/syncFigma.js"),u=e("./state/appState.js");jQuery(document).ready(function(e){var t,r;e(".illiant-settings").length&&e("#save-lp-settings").on("click",function(){(0,a.extractFigmaUser)()}),e(".illiant-page").length&&((0,o.checkKeys)(n.figmaToken,n.currentPlan),t={LicenseID:n.licenseId,FigmaID:n.figmaId,SiteURL:n.siteUrl,PlanType:n.currentPlan,CreationDate:n.created,ExpirationDate:n.expiration},(0,i.connectWebSocketUserCheck)(t),jQuery("#importStyles").on("click",function(){(0,a.proceedWithFigmaExport)("styles")}),jQuery("#connectFigma").on("click",function(){(0,a.proceedWithFigmaExport)("design")}),jQuery("#convertFigma").on("click",function(){(0,a.proceedWithFigmaExport)("convert")}),jQuery("#updateFigma").on("click",function(){(0,a.proceedWithFigmaExport)("update")}),r=e("#global_styles_id").val(),jQuery("#updateStyles").on("click",function(){(0,s.updateStyles)(r)}),jQuery("#retrieveStyles").on("click",function(){(0,s.retrieveStyles)(r)}),jQuery("#illiant-page-selector").select2({placeholder:"Select a page to update",minimumInputLength:0,ajax:{url:illiantscriptsData.ajax_url,type:"POST",dataType:"json",delay:250,data:function(e){return{action:"get_illiant_pages",_ajax_nonce:illiantscriptsData.illiant_nonce,search:e.term||""}},processResults:function(e){return e.success?((e=e.data.pages).forEach(function(e){e.text=e.title}),{results:e}):{results:[]}},cache:!0},language:{loadingMore:function(){return"Loading more results..."},noResults:function(){return"No pages found."},searching:function(){return"Loading..."},inputTooShort:function(){return"Loading..."}},minimumResultsForSearch:0,templateSelection:function(e){return e.text}}),jQuery("#illiant-page-selector").on("select2:select",function(e){var e=e.params.data,t=e.id,r=e.pageID,e=e.frameID;jQuery("#update_id").val(t),jQuery("#update_page_id").val(r),jQuery("#update_frame_id").val(e),jQuery("#updateFigma").removeClass("disabled")}),jQuery("#illiant-page-selector").on("select2:unselect",function(){jQuery("#updateFigma").addClass("disabled")}),jQuery(document).on("click",".figma-frame-item",function(){var e,t;jQuery(this).hasClass("active")||((0,u.updateAppState)({isLoading:!0,loadBox:2}),jQuery(".figma-frame-item").removeClass("active"),jQuery(".frame-direct-link").addClass("hidden"),jQuery(this).addClass("active"),e=jQuery(this).data("node"),t=jQuery(this).data("preview"),jQuery(".convert-box-2").removeClass("no-frame"),jQuery(".convert-box-2").removeClass("novalid-frame"),null===t?(0,c.exportFigmaPreviewImage)(e):(0,l.mountFramePreview)(t,e))}),e(".type-new").removeClass("type-off").addClass("type-on"),e(".type-update").removeClass("type-on").addClass("type-off"),e("#toggle").on("change",function(){e(this).is(":checked")?(e(".type-new").removeClass("type-on").addClass("type-off"),e(".type-update").removeClass("type-off").addClass("type-on")):(e(".type-new").removeClass("type-off").addClass("type-on"),e(".type-update").removeClass("type-on").addClass("type-off"))}),e(".lp-loader-full").delay(500).fadeOut("slow"))})},{"./modules/exportFigmaImages.js":3,"./modules/extractFigma.js":5,"./modules/handleFigmaStyles.js":6,"./modules/syncFigma.js":10,"./modules/websockets.js":12,"./state/appState.js":13,"./state/checkKeys.js":14,"./utils/constants.js":17}],2:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.messages=void 0;e=e("../utils/constants.js");r.messages={keys:{openaiMissing:(0,e.__)("OpenAI API key","illiant-landings"),figmaMissing:(0,e.__)("Figma token key","illiant-landings")},alerts:{missingKeys:(0,e.__)("We have detected that the <strong>Figma access token is missing</strong>.","illiant-landings"),noCredits:(0,e.__)("You have exhausted your credits. To continue, please <strong>use your OpenAI API key</strong> or <strong>upgrade your account for additional credits</strong>.","illiant-landings"),noCreditsPlan:(0,e.__)("You have no remaining monthly credits in your plan. Please consider <strong>Upgrading to a larger plan</strong> or <strong>Contact us</strong> for assistance.","illiant-landings"),checkDocs:(0,e.__)("Make sure to read the documentation on <strong>how to prepare your Figma design</strong> before converting.","illiant-landings"),errorFigmaDesign:(0,e.__)("Error fetching data from Figma: ","illiant-landings"),errorProcessDesign:(0,e.__)("Error importing your design. <strong>Try again</strong> or <strong>contact support</strong>.","illiant-landings"),errorExportImages:(0,e.__)("Error exporting images from Figma: ","illiant-landings"),errorProcessingImages:(0,e.__)("Error processing images: ","illiant-landings"),errorUploadImages:(0,e.__)("Error uploading images to WordPress. Error message: ","illiant-landings"),errorUploadImagesNoDebug:(0,e.__)("Error uploading images to WordPress. <strong>Try again</strong> or <strong>contact support</strong>.","illiant-landings"),errorMissmatchSections:(0,e.__)("We have detected a <strong>mismatch in the number of sections</strong> between DESKTOP and MOBILE.<br> Ensure your design is imported correctly to avoid unexpected results.","illiant-landings"),errorGeneratingLP:(0,e.__)("Error converting your Landing Page: ","illiant-landings"),errorEditingSection:(0,e.__)("Error editing section: ","illiant-landings"),errorProcessLP:(0,e.__)("Error converting your Page. <strong>Try again</strong> or <strong>contact support</strong>.","illiant-landings"),errorEditSection:(0,e.__)("Error editing section. <strong>Try again</strong> or <strong>contact support</strong>.","illiant-landings"),successLP:(0,e.__)("<strong>Your Landing Page has been converted!</strong><br>If there are differences with the imported design, you <strong>can edit your Landing Page with AI or with code</strong>.<br><br>If you need help editing your Landing Page, <strong>we can assist you at no cost!</strong> <a>Contact Support</a>","illiant-landings"),missingFonts1:(0,e.__)("The following fonts are not available in Google Fonts: <strong>","illiant-landings"),missingFonts2:(0,e.__)("</strong> <br> This preview only visualizes Google Fonts, but don't worry! Once you publish the landing page, these fonts will be applied, provided they are installed in your theme.","illiant-landings")},links:{goToSettings:{missingKeys:(0,e.__)("Go to Settings to setup your key","illiant-landings"),url:"admin.php?page=illiant_wplandings"},goToTrial:{basic:(0,e.__)("Start your free trial","illiant-landings"),url:"admin.php?billing_cycle=annual&trial=true&page=illiant_wplandings-pricing"},goToUpgrade:{basic:(0,e.__)("Upgrade your account","illiant-landings"),url:"admin.php?billing_cycle=annual&page=illiant_wplandings-pricing"},goToSupport:{basic:(0,e.__)("Contact Support","illiant-landings"),urlWP:(0,e.__)("https://wordpress.org/support/plugin/illiant-landings/","illiant-landings"),url:"?page=illiant_wplandings-contact"},goToDocs:{basicDocs:(0,e.__)("Go to Documentation","illiant-landings"),url:(0,e.__)("admin.php?page=illiant_wplandings_doc#d-2","illiant-landings"),fontsDocs:(0,e.__)("How we handle fonts","illiant-landings"),fontsUrl:(0,e.__)("admin.php?page=illiant_wplandings_doc#d-5","illiant-landings"),editDocs:(0,e.__)("How to edit your Landing Page","illiant-landings"),editUrl:"admin.php?page=illiant_wplandings_doc#d-4"},goToFAQ:{basicDocs:(0,e.__)("Go to FAQ","illiant-landings"),url:"admin.php?page=illiant_wplandings_faq",errorAIDocs:(0,e.__)("What this error means","illiant-landings"),errorAIUrl:"admin.php?page=illiant_wplandings_faq#d-4",errorFigmaDocs:(0,e.__)("What this error means","illiant-landings"),errorFigmaUrl:"admin.php?page=illiant_wplandings_faq#d-4",errorWPDocs:(0,e.__)("What this error means","illiant-landings"),errorWPUrl:"admin.php?page=illiant_wplandings_faq#d-4"}},modals:{titles:{confirmReset:(0,e.__)("Confirm Reset","illiant-landings"),confirmImport:(0,e.__)("Confirm Conversion","illiant-landings"),invalidURL:(0,e.__)("Invalid URL","illiant-landings"),confirmCreate:(0,e.__)("Confirm Conversion","illiant-landings"),upgradeAccount:(0,e.__)("Upgrade your Account","illiant-landings"),warningsCreate:(0,e.__)("Review this warnings before confirm","illiant-landings"),updatePlugin:(0,e.__)("Update WPLandings Plugin","illiant-landings"),requestLimit:(0,e.__)("You have reached the free AI credits limit","illiant-landings"),invalidFrame:(0,e.__)("Select a valid Figma frame to convert"),noAuto:(0,e.__)("Some sections in your design don't have AUTO layout")},messages:{confirmReset:(0,e.__)("Are you sure you want to reset the current Landing Page? This action cannot be undone.","illiant-landings"),confirmImportDesktop:(0,e.__)("You already have an imported Landing Page. Importing a new design will overwrite it.","illiant-landings"),confirmImportMobile:(0,e.__)("You already have mobile sections. Importing a new design will replace them.","illiant-landings"),invalidURL:(0,e.__)("Please enter a valid Figma file URL.","illiant-landings"),confirmCreate:(0,e.__)("This process may take up to 1 or 2 minutes, depending on the number of sections in your design.<br><br>","illiant-landings"),confirmSections:(0,e.__)("- Your design contains an unusual number of sections. Ensure your Figma design has been correctly imported to avoid unexpected results.<br>","illiant-landings"),confirmImages:(0,e.__)("- Your design contains an unusual number of images. Ensure your Figma design has been correctly imported to avoid unexpected results.<br>","illiant-landings"),confirmImport:(0,e.__)("This process may take up to 1 or 2 minutes, depending on the number of sections and images in your design.<br><br>","illiant-landings"),upgradeAccount:(0,e.__)("To access the One-Click Publish feature, you need to upgrade your account. Start your 30-day free trial now - no commitment for 30 days, cancel anytime!","illiant-landings"),updatePlugin:(0,e.__)("You can enjoy premium features by updating your WPLandings plugin. Follow the instructions.","illiant-landings"),importLimit:(0,e.__)("You've hit the free import limit. To continue, please set up an OpenAI API key.","illiant-landings"),convertLimit:(0,e.__)("You've hit the free convert limit. To continue, please set up an OpenAI API key.","illiant-landings"),editLimit:(0,e.__)("You've hit the free edit limit. To continue, please set up an OpenAI API key.","illiant-landings"),requestLimit:(0,e.__)("You have exhausted your credits. To continue, please <strong>use your OpenAI API key</strong> or <strong>upgrade your account for additional credits</strong>.","illiant-landings"),invalidFrame:(0,e.__)("You are trying to convert a non-frame element. Please select the desired frame in your Figma design, copy its URL, and paste the new URL."),emptyFrame:(0,e.__)("You are trying to convert an empty frame. Please select the desired frame in your Figma design, copy its URL, and paste the new URL."),noAuto:(0,e.__)("Your content will be converted, but you'll need to manually set the layout in the WordPress Page editor.<br><br> For the best results, we recommend configuring these layers of your design with AUTO layout in Figma:<br>")},confirm:{confirmReset:(0,e.__)("Confirm Reset","illiant-landings"),confirmImport:(0,e.__)("Confirm Conversion","illiant-landings"),confirmCreate:(0,e.__)("Confirm Conversion","illiant-landings"),confirmCreateWarning:(0,e.__)("Yes, confirm Conversion","illiant-landings"),confirmUpgrade:(0,e.__)("Save and Upgrade","illiant-landings"),getKey:(0,e.__)("Get an OpenAI API key","illiant-landings")}}}},{"../utils/constants.js":17}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.exportFigmaImages=function(u,e){return new Promise(function(t,r){var n,o,a,i,e,s,c,l=jQuery("#figma_desktop_url").val().match(/design\/([a-zA-Z0-9]{18,})/);l?(l=l[1],n=u.nodeId,o=u.isMultiImage,a=u.canvasData,i=u.boundingData,e=Array.isArray(n)?n.join(","):n,s="",c="jpg",s=Array.isArray(n)?"":"&scale=2",c="png",l="https://api.figma.com/v1/images/".concat(l,"?ids=").concat(e).concat(s,"&format=").concat(c,"&use_absolute_bounds=false"),jQuery.ajax({url:l,type:"GET",beforeSend:function(e){e.setRequestHeader("X-Figma-Token",jQuery("#figma_access_token").val())},success:function(r){var e;Array.isArray(n)?((e=n.map(function(e,t){return{imageUrl:r.images[e],imageDataNode:e,isMultiImage:o,canvasData:a?a[t]:null}}))[0].nodeId=n,e[0].boundingData=i,t(e)):(e={imageUrl:r.images[n],dataNode:n,isMultiImage:o,canvasData:a,boundingData:i},t(e))},error:function(e){r(e);(0,g.updateAppState)({isLoading:!1,loadingBox:1}),(0,d.showNotification)("warning","Error exporting images from Figma"),(0,d.hideNotification)(),(0,d.hideAlerts)(),(0,d.showAlert)("warning",p.messages.alerts.errorExportImages,e.responseJSON.err,p.messages.links.goToFAQ.errorFigmaDocs,p.messages.links.goToFAQ.errorFigmaUrl,2);e=jQuery("#figma_desktop_url").val(),e={ErrorMessage:"generic error",ErrorType:"Error exporting images from Figma",SiteURL:m.siteUrl,wpVersion:m.wpVersion,pluginVersion:m.pluginVersion,figmaURL:e,figmaToken:m.figmaToken};(0,f.connectWebSocketErrorLog)(e)}})):r("Invalid Figma URL")})},r.exportFigmaPreviewImage=function(r){return new Promise(function(o,a){var t,e=jQuery("#figma_desktop_url").val().match(/design\/([a-zA-Z0-9]{18,})/);e?(e=e[1],t=r,e="https://api.figma.com/v1/images/".concat(e,"?ids=").concat(t).concat("&scale=0.5","&format=").concat("jpg","&use_absolute_bounds=false"),jQuery.ajax({url:e,type:"GET",beforeSend:function(e){e.setRequestHeader("X-Figma-Token",jQuery("#figma_access_token").val())},success:function(e){var r,n=t.replace(/-/g,":");e&&e.images&&e.images[n]?(r=e.images[n],jQuery.ajax({url:illiantscriptsData.ajax_url,type:"POST",data:{action:"save_figma_preview_image",_ajax_nonce:illiantscriptsData.illiant_nonce,nodeId:n,imageUrl:r},success:function(e){var t;e.success?((t=jQuery(".figma-frame-item[data-node='".concat(n,"']"))).data("preview",r),t.attr("data-preview",r),(0,i.mountFramePreview)(r,n),o(e)):((0,g.updateAppState)({isLoading:!1}),jQuery(".frame-preview-img img").attr("src",""),jQuery("#page_title").val("Not found"),jQuery(".frame-preview-img p span").text("Not found"),console.error("Failed to save preview image URL: "+e.data),a(e.data))},error:function(e){jQuery(".frame-preview-img img").attr("src",""),jQuery("#page_title").val("Not found"),jQuery(".frame-preview-img p span").text("Not found");var t=jQuery("#figma_desktop_url").val(),t=((0,g.updateAppState)({isLoading:!1}),{ErrorMessage:"Ajax error",ErrorType:"Error exporting Figma preview",SiteURL:m.siteUrl,wpVersion:m.wpVersion,pluginVersion:m.pluginVersion,figmaURL:t,figmaToken:m.figmaToken});(0,f.connectWebSocketErrorLog)(t),a(e)}})):(jQuery(".frame-preview-img img").attr("src",""),jQuery("#page_title").val("Not found"),jQuery(".frame-preview-img p span").text("Not found"),e=jQuery("#figma_desktop_url").val(),(0,g.updateAppState)({isLoading:!1}),e={ErrorMessage:"Figma API no images returned",ErrorType:"Error exporting Figma preview",SiteURL:m.siteUrl,wpVersion:m.wpVersion,pluginVersion:m.pluginVersion,figmaURL:e,figmaToken:m.figmaToken},(0,f.connectWebSocketErrorLog)(e),a("Failed to get image URL from Figma."))},error:function(e){var t=jQuery("#figma_desktop_url").val(),t=((0,g.updateAppState)({isLoading:!1}),{ErrorMessage:"generic error",ErrorType:"Error exporting design image from Figma",SiteURL:m.siteUrl,wpVersion:m.wpVersion,pluginVersion:m.pluginVersion,figmaURL:t,figmaToken:m.figmaToken});(0,f.connectWebSocketErrorLog)(t)}})):a("Invalid Figma URL")})};var g=e("../state/appState.js"),d=e("../utils/components.js"),p=e("../messages/messages.js"),m=e("../utils/constants.js"),f=e("./websockets.js"),i=e("./syncFigma.js")},{"../messages/messages.js":2,"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"./syncFigma.js":10,"./websockets.js":12}],4:[function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}Object.defineProperty(r,"__esModule",{value:!0}),r.extractHtmlAndCss=function(e,a){var i=(e.match(/<style>([\s\S]*?)<\/style>/)||["",""])[1],s=e.replace(/<style>[\s\S]*?<\/style>/,"").trim(),e=(function(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?n(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(s.matchAll(/<[^>]*style="([^"]*)"[^>]*>/g)).forEach(function(e){var t=e[0],e=e[1].replace(/; /g,";    "),r=t.match(/class="([^"]*)"/),r=r?r[1]:"",n=r.split(" ").filter(Boolean).map(function(e){return".".concat(e)}).join(""),o=n?"#".concat(a," ").concat(n).trim():"";n?(n=new RegExp("".concat(o,"\\s*{"),"g"),i.match(n)?i=i.replace(n,"$&    ".concat(e)):i+="".concat(o," {    ").concat(e,"}"),s=s.replace(t,t.replace(/style="[^"]*"/,""))):(n="class-".concat(Math.floor(1e8+9e8*Math.random())),o="#".concat(a," .").concat(n),s=s.replace(t,t.replace(/style="[^"]*"/,'class="'.concat(r," ").concat(n,'"'))),i+="".concat(o," {    ").concat(e,"}"))}),jQuery("#landing_bg").val());return s='<div id="'.concat(a,'" class="alignfull" style="background-color:').concat(e,'">').concat(s,"</div>"),{id:a,html:s,css:i}}},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.extractFigmaUser=function(){var t=jQuery("#figmaKey").val();jQuery.ajax({url:"https://api.figma.com/v1/me",type:"GET",beforeSend:function(e){(0,g.updateAppState)({isLoading:!0}),e.setRequestHeader("X-Figma-Token",t)},success:function(e){jQuery("#figmaId").val(e.id),jQuery("#lp-settings").submit()},error:function(e){(0,g.updateAppState)({isLoading:!1}),(0,u.showAlert)("warning",c.messages.alerts.errorFigmaDesign,e.responseJSON.err,c.messages.links.goToFAQ.errorFigmaDocs,c.messages.links.goToFAQ.errorFigmaUrl,1)}})},r.proceedWithFigmaExport=function(n){var o,a,i,e,s=jQuery("#figma_desktop_url").val(),t=s.match(/design\/([a-zA-Z0-9]{18,})/);t&&(t=t[1],e=s.match(/node-id=([0-9\-]+)/))?(o=e[1],a="update"===n?jQuery("#update_frame_id").val():jQuery(".figma-frame-item.active").data("node"),i=jQuery(".figma-frame-item.active").data("page"),e="convert"===n||"design"===n||"update"===n?"https://api.figma.com/v1/files/".concat(t):"https://api.figma.com/v1/files/".concat(t,"?ids=").concat(a),"design"===n?(0,u.showNotification)("info","Connecting Figma design",null,null):(0,u.showNotification)("info","Converting Figma design",1,4),jQuery.ajax({url:e,type:"GET",beforeSend:function(e){(0,g.updateAppState)("design"===n?{isLoading:!0,loadBox:1}:"convert"===n||"update"===n?{isLoading:!0,loadBox:2}:{isLoading:!0,loadBox:3}),e.setRequestHeader("X-Figma-Token",l.figmaToken)},success:function(e){var t=e.document,r=e.styles;"design"===n?(0,m.saveFigmaDesignToWP)(t,r,s,o):("styles"===n?(0,d.connectWebSocketFigma):(0,p.retrieveGlobalStyles))(e,a,i,n,s)},error:function(e){(0,g.updateAppState)({isLoading:!1}),(0,u.showNotification)("warning","Error converting design"),(0,u.hideNotification)(),(0,u.showAlert)("warning",c.messages.alerts.errorFigmaDesign,e.responseJSON.err,c.messages.links.goToFAQ.errorFigmaDocs,c.messages.links.goToFAQ.errorFigmaUrl,2);var t=jQuery("#figma_desktop_url").val(),e={ErrorMessage:e.responseJSON.err,ErrorType:"Extract figma API",SiteURL:l.siteUrl,wpVersion:l.wpVersion,pluginVersion:l.pluginVersion,figmaURL:t,figmaToken:l.figmaToken};(0,d.connectWebSocketErrorLog)(e)}})):(0,u.showModal)(c.messages.modals.titles.invalidURL,c.messages.modals.messages.invalidURL,!1)};var c=e("../messages/messages.js"),l=e("../utils/constants.js"),u=e("../utils/components.js"),g=e("../state/appState.js"),d=e("./websockets.js"),p=e("./handleFigmaStyles.js"),m=e("./syncFigma.js")},{"../messages/messages.js":2,"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"./handleFigmaStyles.js":6,"./syncFigma.js":10,"./websockets.js":12}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.retrieveGlobalStyles=function(r,n,o,a,i){var e=jQuery("#global_styles_id").val(),t=illiantscriptsData.root||"";t.endsWith("/")||(t+="/");jQuery.ajax({url:t+"wp/v2/global-styles/"+e,method:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",illiantscriptsData.nonce)},success:function(e){(0,s.connectWebSocketFigma)(r,n,o,a,i,e)},error:function(e){var t=jQuery("#figma_desktop_url").val(),e={ErrorMessage:"Ajax error "+e.responseJSON.message,ErrorType:"Retrieve Gloval styles",SiteURL:c.siteUrl,wpVersion:c.wpVersion,pluginVersion:c.pluginVersion,figmaURL:t,figmaToken:c.figmaToken};(0,s.connectWebSocketFigma)(r,n,o,a,i,{settings:{},styles:{}}),(0,s.connectWebSocketErrorLog)(e)}})},r.retrieveStyles=function(e){var t=illiantscriptsData.root||"";t.endsWith("/")||(t+="/");jQuery.ajax({url:t+"wp/v2/global-styles/"+e,method:"GET",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",illiantscriptsData.nonce)},success:function(e){console.log("response "+JSON.stringify(e))},error:function(e){var t=jQuery("#figma_desktop_url").val(),t=((0,n.updateAppState)({isLoading:!1}),{ErrorMessage:"Ajax error",ErrorType:"Retrieve  styles",SiteURL:c.siteUrl,wpVersion:c.wpVersion,pluginVersion:c.pluginVersion,figmaURL:t,figmaToken:c.figmaToken});(0,s.connectWebSocketErrorLog)(t)}})},r.saveStylesToTheme=function(e){jQuery.ajax({url:illiantscriptsData.ajax_url,type:"POST",data:{action:"save_styles_to_theme",_ajax_nonce:illiantscriptsData.illiant_nonce,processedStyles:JSON.stringify(e)},success:function(e){e.success?((0,n.updateAppState)({isLoading:!1}),(0,o.showNotification)("success","Styles saved successfully.")):((0,n.updateAppState)({isLoading:!1}),console.error("Error saving styles: ",e.data),(0,o.showNotification)("error","Failed to save styles.")),(0,o.hideNotification)()},error:function(e){console.error("AJAX error: ",e);(0,n.updateAppState)({isLoading:!1}),(0,o.showNotification)("error","Error saving styles to the theme."),(0,o.hideNotification)()}})},r.updateStyles=function(t){var r=illiantscriptsData.root||"";r.endsWith("/")||(r+="/");jQuery.ajax({url:"/demo-new-9-4/wp-content/themes/twentytwentyfour/styles/test.json",method:"GET",dataType:"json",success:function(e){jQuery.ajax({url:r+"wp/v2/global-styles/"+t,method:"POST",beforeSend:function(e){e.setRequestHeader("X-WP-Nonce",illiantscriptsData.nonce)},data:JSON.stringify(e),contentType:"application/json",success:function(e){alert("Style updated successfully.")},error:function(e){alert("Error updating style.")}})},error:function(e){alert("Error fetching theme.json.")}})};var s=e("./websockets.js"),n=e("../state/appState.js"),o=e("../utils/components.js"),c=e("../utils/constants.js")},{"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"./websockets.js":12}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.exportFigmaImageFills=g,r.proceedImport=function(e,t){jQuery("#landing_bg").val(e.frameBG);var r=null;e&&"update"===e.conversionType?(n=jQuery("#update_page_id").val(),r=jQuery("#update_id").val()):n=(0,l.generateRandomId)();var n=[(0,u.extractHtmlAndCss)(e.code,n)],o=JSON.stringify(n),a=jQuery(".figma-frame-item[data-node='".concat(t,"']")).data("preview");n[0].sectionImage=a,n[0].frameId=t,n[0].conversionType=e.conversionType,n[0].updateId=r,jQuery("#sectionsJSON").val(o),(0,i.updateNotification)("Processing images",2,4),g(n)};var n=e("../messages/messages.js"),o=e("../utils/constants.js"),a=e("../state/appState.js"),i=e("../utils/components.js"),s=e("./processImages.js"),c=e("./websockets.js"),l=e("../utils/utils.js"),u=e("./extractCode.js");function g(t){var e=jQuery("#figma_desktop_url").val().match(/design\/([a-zA-Z0-9]{18,})/)[1],e="https://api.figma.com/v1/files/".concat(e,"/images");jQuery.ajax({url:e,type:"GET",beforeSend:function(e){e.setRequestHeader("X-Figma-Token",o.figmaToken)},success:function(e){e=e.meta.images;(0,s.processImageNodes)(t,e)},error:function(e){(0,a.updateAppState)({isLoading:!1}),(0,i.showNotification)("warning","Error converting design"),(0,i.hideNotification)(),(0,i.showAlert)("warning",n.messages.alerts.errorFigmaDesign,e.responseJSON.err,n.messages.links.goToFAQ.errorFigmaDocs,n.messages.links.goToFAQ.errorFigmaUrl,2);var t=jQuery("#figma_desktop_url").val(),e={ErrorMessage:e.responseJSON.err,ErrorType:"Extract image fills API",SiteURL:o.siteUrl,wpVersion:o.wpVersion,pluginVersion:o.pluginVersion,figmaURL:t,figmaToken:o.figmaToken};(0,c.connectWebSocketErrorLog)(e)}})}},{"../messages/messages.js":2,"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"../utils/utils.js":18,"./extractCode.js":4,"./processImages.js":8,"./websockets.js":12}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.processImageNodes=function(e,t){return n.apply(this,arguments)};var o=e("../messages/messages.js"),a=e("../utils/constants.js"),i=e("../state/appState.js"),g=e("../utils/utils.js"),d=e("../utils/components.js"),p=e("./websockets.js"),m=e("./exportFigmaImages.js"),f=e("./uploadImages.js");function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function A(){A=function(){return i};var c,i={},e=Object.prototype,l=e.hasOwnProperty,u=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(c){a=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var o,a,i,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new E(n||[]);return u(t,"_invoke",{value:(o=e,a=r,i=n,s=d,function(e,t){if(s===m)throw Error("Generator is already running");if(s===f){if("throw"===e)throw t;return{value:c,done:!0}}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){r=function e(t,r){var n=r.method,o=t.iterator[n];if(o===c)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=c,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=g(o,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=c),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(s===d)throw s=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s=m;r=g(o,a,i);if("normal"===r.type){if(s=i.done?f:p,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(s=f,i.method="throw",i.arg=r.arg)}})}),t}function g(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=s;var d="suspendedStart",p="suspendedYield",m="executing",f="completed",y={};function h(){}function v(){}function j(){}var t={},w=(a(t,n,function(){return this}),Object.getPrototypeOf),w=w&&w(w(T([]))),b=(w&&w!==e&&l.call(w,n)&&(t=w),j.prototype=h.prototype=Object.create(t));function _(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function S(i,s){var t;u(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,o){var a,e=g(i[e],i,r);if("throw"!==e.type)return(r=(a=e.arg).value)&&"object"==x(r)&&l.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):s.resolve(r).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)});o(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function T(t){if(t||""===t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(l.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=c,e.done=!0,e}).next=e}throw new TypeError(x(t)+" is not iterable")}return u(b,"constructor",{value:v.prototype=j,configurable:!0}),u(j,"constructor",{value:v,configurable:!0}),v.displayName=a(j,o,"GeneratorFunction"),i.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,j):(e.__proto__=j,a(e,o,"GeneratorFunction")),e.prototype=Object.create(b),e},i.awrap=function(e){return{__await:e}},_(S.prototype),a(S.prototype,r,function(){return this}),i.AsyncIterator=S,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new S(s(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},_(b),a(b,o,"Generator"),a(b,n,function(){return this}),a(b,"toString",function(){return"[object Generator]"}),i.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=T,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=c),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=l.call(o,"catchLoc"),s=l.call(o,"finallyLoc");if(i&&s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&l.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(r=o.completion).type&&(n=r.arg,L(o)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=c),y}},i}function c(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function y(s){return function(){var e=this,i=arguments;return new Promise(function(t,r){var n=s.apply(e,i);function o(e){c(n,t,r,o,a,"next",e)}function a(e){c(n,t,r,o,a,"throw",e)}o(void 0)})}}function n(){return(n=y(A().mark(function e(s,c){var l,u,t,r,n;return A().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l=!1,u=s[0].id,s[0].conversionType,t=s.map(function(){var t=y(A().mark(function e(t){var r,n,o,a,i;return A().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(0,g.findImageNodes)(s,[]),r=(0,g.findImageFillNodes)(s,c,[]),n=[],o=[],0<a.length)return a=a.slice(0,30),a=a.map(function(e){return(0,m.exportFigmaImages)(e,!0)}),e.next=9,Promise.all(a);e.next=11;break;case 9:e.sent.forEach(function(e){(Array.isArray(e)?o:n).push(e)});case 11:if(0<r.length&&0<(a=Array.from(new Set(r.filter(function(e){return null!=e&&void 0!==e&&""!==e})))).length&&(n=n.concat(a)),0<o.length)return e.prev=13,e.next=16,(0,p.connectWebSocketImageMerge)(o,u);e.next=23;break;case 16:(i=e.sent)&&i.mergedImages?i.mergedImages.forEach(function(e){n.push({imageUrl:e.imageUrl,dataNode:e.nodeId,isMultiImage:!0,canvasData:null,boundingData:null})}):console.error("Failed to get merged images"),e.next=23;break;case 20:e.prev=20,e.t0=e.catch(13),console.error("Error during WebSocket communication:",e.t0);case 23:if(0===n.length&&0===r.length)return t.contentImages=[],e.abrupt("return");e.next=26;break;case 26:return l=!0,(0,f.uploadImages)(n,s),e.abrupt("return");case 29:case"end":return e.stop()}},e,null,[[13,20]])}));return function(e){return t.apply(this,arguments)}}()),e.prev=5,e.next=8,Promise.all(t);case 8:l||(jQuery("#sectionsJSON").val(JSON.stringify(s)),t=jQuery("#figma_desktop_url").val(),r={code:s[0],LicenseID:a.licenseId,SiteURL:a.siteUrl,FigmaID:a.figmaId,wpVersion:a.wpVersion,pluginVersion:a.pluginVersion,figmaURL:t,figmaToken:a.figmaToken,auto:"none",type:s[0].conversionType||"convert"},(0,p.connectWebSocketConvert)(r)),e.next=23;break;case 11:e.prev=11,e.t0=e.catch(5),console.error(e.t0),r={isLoading:!1},(0,i.updateAppState)(r),(0,d.showNotification)("warning","Error converting design"),(0,d.hideNotification)(),(0,d.hideAlerts)(),(0,d.showAlert)("warning",o.messages.alerts.errorProcessLP,!1,o.messages.links.goToSupport.basic,o.messages.links.goToSupport.url,2),n=jQuery("#figma_desktop_url").val(),n={ErrorMessage:"processImageNodes imageExportPromises catch error",ErrorType:"Error importing design",SiteURL:a.siteUrl,wpVersion:a.wpVersion,pluginVersion:a.pluginVersion,figmaURL:n,figmaToken:a.figmaToken},(0,p.connectWebSocketErrorLog)(n);case 23:case"end":return e.stop()}},e,null,[[5,11]])}))).apply(this,arguments)}},{"../messages/messages.js":2,"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"../utils/utils.js":18,"./exportFigmaImages.js":3,"./uploadImages.js":11,"./websockets.js":12}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.publishPageAJAX=function(e){var t=illiantscriptsData.ajax_url;jQuery.ajax({url:t,type:"POST",data:{action:"publish_landing_page",_ajax_nonce:illiantscriptsData.illiant_nonce,landingData:e},success:function(e){e.success?((0,n.updateAppState)({isLoading:!1}),(0,o.hideNotification)(),jQuery(".frame-direct-link").removeClass("hidden"),jQuery(".frame-direct-link .page-link").attr("href",e.data.view_link)):((0,n.updateAppState)({isLoading:!1}),(0,o.showNotification)("warning","Error converting design"),(0,o.hideNotification)(),(0,o.hideAlerts)(),(0,o.showAlert)("warning",s.messages.alerts.errorProcessLP,!1,s.messages.links.goToSupport.basic,s.messages.links.goToSupport.url,2),e=jQuery("#figma_desktop_url").val(),e={ErrorMessage:"Ajax error",ErrorType:"Publish page",SiteURL:i.siteUrl,wpVersion:i.wpVersion,pluginVersion:i.pluginVersion,figmaURL:e,figmaToken:i.figmaToken},(0,a.connectWebSocketErrorLog)(e))},error:function(e,t,r){console.log("AJAX Error: "+r);(0,n.updateAppState)({isLoading:!1}),(0,o.showNotification)("warning","Error converting design"),(0,o.hideNotification)(),(0,o.hideAlerts)(),(0,o.showAlert)("warning",s.messages.alerts.errorProcessLP,!1,s.messages.links.goToSupport.basic,s.messages.links.goToSupport.url,2);r=jQuery("#figma_desktop_url").val(),r={ErrorMessage:"Generic error",ErrorType:"Publish page",SiteURL:i.siteUrl,wpVersion:i.wpVersion,pluginVersion:i.pluginVersion,figmaURL:r,figmaToken:i.figmaToken};(0,a.connectWebSocketErrorLog)(r)}})};var n=e("../state/appState.js"),o=e("../utils/components.js"),a=e("./websockets.js"),i=e("../utils/constants.js"),s=e("../messages/messages.js")},{"../messages/messages.js":2,"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"./websockets.js":12}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mountFramePreview=function(e,t){var t=jQuery(".figma-frame-item[data-node='".concat(t,"']")),t=jQuery(".figma-frame-name",t).text(),r=(jQuery("#page_title").val(t),jQuery(".frame-preview-img"));r.length&&r.html("<p>Frame preview: <span>".concat(t,'</span></p><img src="').concat(e,'" alt="Frame Preview" />'));(0,i.updateAppState)({isLoading:!1,loadBox:null})},r.saveFigmaDesignToWP=function(e,t,r,n){e=e.children.filter(function(e){return"CANVAS"===e.type}).map(function(e){return{id:e.id,name:e.name,frames:e.children.filter(function(e){return"FRAME"===e.type}).map(function(e){return{id:e.id,name:e.name}})}});jQuery.ajax({url:illiantscriptsData.ajax_url,type:"POST",data:{action:"save_illiant_design_data",_ajax_nonce:illiantscriptsData.illiant_nonce,pages:e,styles:t,figmaURL:r,selectedNode:n},success:function(e){var t;e.success?e.data&&"updated"===e.data.status?(t=n,jQuery.ajax({url:illiantscriptsData.ajax_url,type:"POST",data:{action:"get_updated_figma_structure_html",_ajax_nonce:illiantscriptsData.illiant_nonce},success:function(e){e.success&&e.data.html?((0,i.updateAppState)({isLoading:!1}),jQuery(".convert-ui").addClass("active"),jQuery(".doc-stucture").html(e.data.html),(0,a.showNotification)("success","Figma design connected!",null,null),(0,a.hideNotification)(),0<jQuery(".doc-stucture .figma-frame-item.active").length?((0,i.updateAppState)({isLoading:!0,loadBox:2}),e=e.data.selectedNode||t,(0,o.exportFigmaPreviewImage)(e)):(jQuery(".convert-box-2").addClass("no-frame"),jQuery(".convert-box-2").removeClass("novalid-frame"))):((0,i.updateAppState)({isLoading:!1}),(0,a.showNotification)("warning","Error converting design"),(0,a.hideNotification)(),(0,a.hideAlerts)(),(0,a.showAlert)("warning",l.messages.alerts.errorProcessLP,!1,l.messages.links.goToSupport.basic,l.messages.links.goToSupport.url,2),e=jQuery("#figma_desktop_url").val(),e={ErrorMessage:"Ajax error",ErrorType:"Retrieve Figma structure",SiteURL:c.siteUrl,wpVersion:c.wpVersion,pluginVersion:c.pluginVersion,figmaURL:e,figmaToken:c.figmaToken},(0,s.connectWebSocketErrorLog)(e))},error:function(e){console.log(e);(0,i.updateAppState)({isLoading:!1}),(0,a.showNotification)("warning","Error converting design"),(0,a.hideNotification)(),(0,a.hideAlerts)(),(0,a.showAlert)("warning",l.messages.alerts.errorProcessLP,!1,l.messages.links.goToSupport.basic,l.messages.links.goToSupport.url,2);e=jQuery("#figma_desktop_url").val(),e={ErrorMessage:"Generuc error",ErrorType:"Retrieve Figma structure",SiteURL:c.siteUrl,wpVersion:c.wpVersion,pluginVersion:c.pluginVersion,figmaURL:e,figmaToken:c.figmaToken};(0,s.connectWebSocketErrorLog)(e)}})):(e.data&&"up-to-date"===e.data.status?((0,i.updateAppState)({isLoading:!1}),(0,a.showNotification)("info","Figma design data is already up to date",1,4)):(0,a.showNotification)("info","Figma design saved successfully",1,4),(0,a.hideNotification)()):((0,i.updateAppState)({isLoading:!1}),(0,a.showNotification)("warning","Error converting design"),(0,a.hideNotification)(),(0,a.hideAlerts)(),(0,a.showAlert)("warning",l.messages.alerts.errorProcessLP,!1,l.messages.links.goToSupport.basic,l.messages.links.goToSupport.url,2),e=jQuery("#figma_desktop_url").val(),e={ErrorMessage:"Ajax error",ErrorType:"Save Figma design",SiteURL:c.siteUrl,wpVersion:c.wpVersion,pluginVersion:c.pluginVersion,figmaURL:e,figmaToken:c.figmaToken},(0,s.connectWebSocketErrorLog)(e))},error:function(e){console.log(e);(0,i.updateAppState)({isLoading:!1}),(0,a.showNotification)("warning","Error converting design"),(0,a.hideNotification)(),(0,a.hideAlerts)(),(0,a.showAlert)("warning",l.messages.alerts.errorProcessLP,!1,l.messages.links.goToSupport.basic,l.messages.links.goToSupport.url,2);e=jQuery("#figma_desktop_url").val(),e={ErrorMessage:"Genruc error",ErrorType:"Save Figma design",SiteURL:c.siteUrl,wpVersion:c.wpVersion,pluginVersion:c.pluginVersion,figmaURL:e,figmaToken:c.figmaToken};(0,s.connectWebSocketErrorLog)(e)}})};var o=e("./exportFigmaImages.js"),a=e("../utils/components.js"),i=e("../state/appState.js"),s=e("./websockets.js"),c=e("../utils/constants.js"),l=e("../messages/messages.js")},{"../messages/messages.js":2,"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"./exportFigmaImages.js":3,"./websockets.js":12}],11:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.updateHtmlWithImages=g,r.uploadImages=function(o,a){var i=[],s={sectionId:a[0].id,uploadedImageUrls:[]},c=o.length,l=0;(0,u.updateNotification)("Uploading ".concat(l,"/").concat(c," images to WordPress"),3,4),function t(e){var r,n;e>=o.length?Promise.all(i).then(function(e){e.forEach(function(e){e&&e.uploadedImageUrls&&(s.uploadedImageUrls=s.uploadedImageUrls.concat(e.uploadedImageUrls))}),-1!==(e=a.findIndex(function(e){return e.id===s.sectionId}))&&(a[e].contentImages=s.uploadedImageUrls),jQuery("#sectionsJSON").val(JSON.stringify(a)),jQuery("#excess_mobile_sections").val(""),(0,u.updateNotification)("Converting Figma design",4,4),g(a)}).catch(function(e){console.error("Error in Promise.all for image uploads:",e),e=jQuery("#figma_desktop_url").val(),e={ErrorMessage:"Upload promise error",ErrorType:"upload image",SiteURL:p.siteUrl,wpVersion:p.wpVersion,pluginVersion:p.pluginVersion,figmaURL:e,figmaToken:p.figmaToken},console.log("Logging error data:",e),(0,m.connectWebSocketErrorLog)(e)}):(r=Math.min(e+3,o.length),n=o.slice(e,r).map(function(e){var r,s,t=a[0].id;return r=e,s=t,new Promise(function(t,i){jQuery.ajax({url:illiantscriptsData.ajax_url,type:"POST",dataType:"json",data:{action:"upload_figma_images",nonce:illiantscriptsData.illiant_nonce,sectionId:s,images:[{imageUrl:r.imageUrl,nodeId:r.imageRef||r.dataNode,imageDescription:"description"}]},success:function(e){e.success?t({sectionId:s,uploadedImageUrls:e.data.uploadedImageUrls}):i(e.data.debugMessages)},error:function(e,t,r){var n,o,a;console.error("AJAX Error for section ".concat(s,":"),r),429===e.status&&(console.warn("Rate limit exceeded. Too many requests."),e=e.getResponseHeader("Retry-After"),e="Too many requests. Retry after ".concat(e||"unknown"," seconds."),n=s,o=r,a=jQuery("#figma_desktop_url").val(),e={ErrorMessage:e,ErrorType:"upload image",SiteURL:p.siteUrl,wpVersion:p.wpVersion,pluginVersion:p.pluginVersion,figmaURL:a,figmaToken:p.figmaToken,SectionId:n,ErrorDetails:o},console.log("Logging error data:",e),(0,m.connectWebSocketErrorLog)(e)),i(r)}})})}),Promise.all(n).then(function(e){e.forEach(function(e){e&&e.uploadedImageUrls&&(s.uploadedImageUrls=s.uploadedImageUrls.concat(e.uploadedImageUrls))}),i=i.concat(n),c<(l+=3)&&(l=c),(0,u.updateNotification)("Uploading ".concat(l,"/").concat(c," images to WordPress"),3,4),setTimeout(function(){t(r)},100)}).catch(function(e){console.error("Error in batch upload:",e)}))}(0)};e("../messages/messages.js");var u=e("../utils/components.js"),p=e("../utils/constants.js"),m=(e("../state/appState.js"),e("./websockets.js"));function g(e){var s=e[0].html,c=e[0].css,t=e[0].contentImages,l=Array.from(s.matchAll(/data-node="([^"]*)"/g)).map(function(e){return{original:e[0],cleaned:e[1].replace(/[:;]/g,"")}}),u=Array.from(s.matchAll(/data-repeated="([^"]*)"/g)).map(function(e){return{original:e[0],cleaned:e[1].replace(/[:;]/g,"")}}),g=Array.from(s.matchAll(/data-multinode="([^"]*)"/g)).map(function(e){return{original:e[0],cleaned:e[1].replace(/[:;]/g,"")}}),d=Array.from(s.matchAll(/data-multi="([^"]*)"/g)).map(function(e){return{original:e[0],cleaned:e[1].replace(/[:;,]/g,"")}}),t=(t.forEach(function(e){var n=e.url,e=n.match(/page-\d+-([a-zA-Z0-9]+)(?:-\d+)?\.(jpg|png)/);if(e){for(var o,a=e[1].replace(/[:;]/g,""),t=new RegExp('(<[^>]+data-ref="'.concat(a,'"[^>]*>)'),"g"),i=function(e,t,r){var n;return/img/i.test(e)?((n=e.replace(/src\s*=\s*"[^"]*"/,'src="'.concat(t,'"'))).includes('src="'.concat(t,'"'))||(n=n.replace(/<img/,'<img src="'.concat(t,'"'))),r=r.replace(e,n)):/div/i.test(e)&&(n=e.match(/class="([^"]*)"/))&&(e=n[1].trim(),n=new RegExp("\\.".concat(e.replace(/\s+/g,"\\s*"),"\\s*{[^}]*background-image:\\s*url\\([^)]*\\)"),"g"),e=".".concat(e,' { background-image: url("').concat(t,'"); }'),n.test(c)?c=c.replace(n,e):c+="\n".concat(e)),r};null!==(o=t.exec(s));){var r=o[1];s=i(r,n,s)}l.forEach(function(e){if(e.cleaned.includes(a))for(var t=new RegExp("(<[^>]+".concat(e.original,"[^>]*>)"),"g");null!==(o=t.exec(s));){var r=o[1];s=i(r,n,s)}}),u.forEach(function(e){if(e.cleaned.includes(a))for(var t=new RegExp("(<[^>]+".concat(e.original,"[^>]*>)"),"g");null!==(o=t.exec(s));){var r=o[1];s=i(r,n,s)}}),g.forEach(function(e){if(e.cleaned.includes(a))for(var t=new RegExp("(<[^>]+".concat(e.original,"[^>]*>)"),"g");null!==(o=t.exec(s));){var r=o[1];s=i(r,n,s)}}),d.forEach(function(e){if(e.cleaned.includes(a))for(var t=new RegExp("(<[^>]+".concat(e.original,"[^>]*>)"),"g");null!==(o=t.exec(s));){var r=o[1];s=i(r,n,s)}})}}),s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/data-ref="[^"]*"/g,"")).replace(/data-node="[^"]*"/g,"")).replace(/data-multinode="[^"]*"/g,"")).replace(/data-repeated="[^"]*"/g,"")).replace(/data-multi="[^"]*"/g,"")).replace(/data-canvas='[^']*'/g,"")).replace(/data-canvas="[^"]*"/g,"")).replace(/data-bounding='[^']*'/g,"")).replace(/data-bounding="[^"]*"/g,""),e[0].html=s,e[0].css=c,jQuery("#sectionsJSON").val(JSON.stringify(e)),jQuery("#figma_desktop_url").val()),t={code:e[0],LicenseID:p.licenseId,SiteURL:p.siteUrl,FigmaID:p.figmaId,wpVersion:p.wpVersion,pluginVersion:p.pluginVersion,figmaURL:t,figmaToken:p.figmaToken,auto:"none",type:e[0].conversionType||"convert"};(0,m.connectWebSocketConvert)(t)}},{"../messages/messages.js":2,"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"./websockets.js":12}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.connectWebSocketConvert=function(t){var e=l.convertIP,r=new WebSocket(e),n=t.code.conversionType||"convert";r.onopen=function(){return r.send(JSON.stringify(t))},r.onmessage=function(e){e=JSON.parse(e.data).result.replace(/^"|"$/g,"").replace(/\\"/g,'"').replace(/\\\//g,"/");(0,p.showNotification)("success","Figma design converted!",null,null),(0,p.hideNotification)(),jQuery("#landing_blocks").val(e),(0,o.publishPageAJAX)({title:jQuery("#page_title").val(),landing_blocks:e,frameID:t.code.frameId,pageID:t.code.id,conversionType:n,updateId:jQuery("#update_id").val()}),r.close()},r.onerror=function(e){r.close()},r.onclose=function(){return console.log("WebSocket is closed now.")}},r.connectWebSocketErrorLog=y,r.connectWebSocketFigma=function(t,n,r,o,a,i){var s=new WebSocket(l.importDesignIP);s.onopen=function(){console.log("Connected to WebSocket server");var e=f(f({},t),{},{nodeId:n,type:o,figmaId:l.figmaId,pageId:r,siteUrl:l.siteUrl,figmaUrl:a,figmaToken:l.figmaToken,theme:i});s.send(JSON.stringify(e))},s.onmessage=function(e){var t,r=JSON.parse(e.data);"error"===r.type?((0,u.updateAppState)({isLoading:!1}),(0,p.showNotification)("warning","Error converting design"),(0,p.hideNotification)(),(0,p.showAlert)("warning",c.messages.alerts.errorProcessLP,!1,c.messages.links.goToSupport.basic,c.messages.links.goToSupport.url,2),t=jQuery("#figma_desktop_url").val(),y({ErrorMessage:"Error on FIGMA service",ErrorType:"Process figma design",SiteURL:l.siteUrl,wpVersion:l.wpVersion,pluginVersion:l.pluginVersion,figmaURL:t,figmaToken:l.figmaToken})):"warning"===r.type?((0,u.updateAppState)({isLoading:!1}),(0,p.hideNotification)(),jQuery(".convert-box-2").addClass("novalid-frame"),jQuery(".convert-box-2").removeClass("no-frame"),t=jQuery("#figma_desktop_url").val(),y({ErrorMessage:"Warning on FIGMA service",ErrorType:"No valid frame",SiteURL:l.siteUrl,wpVersion:l.wpVersion,pluginVersion:l.pluginVersion,figmaURL:t,figmaToken:l.figmaToken})):"flag"===r.type?(e=r.auto.join(", "),t=c.messages.modals.messages.noAuto+"\n\n"+e,(0,p.showModal)(c.messages.modals.titles.noAuto,t,!0,c.messages.modals.confirm.confirmImport,function(){return(0,g.proceedImport)(r,n)},!0,!0,!1)):"convert"===r.conversionType||"update"===r.conversionType?(0,g.proceedImport)(r,n):(0,d.saveStylesToTheme)(r.processedStyles)},s.onerror=function(e){(0,u.updateAppState)({isLoading:!1}),(0,p.showNotification)("warning","Error converting design"),(0,p.hideNotification)(),(0,p.showAlert)("warning",c.messages.alerts.errorProcessLP,!1,c.messages.links.goToSupport.basic,c.messages.links.goToSupport.url,2);var t=jQuery("#figma_desktop_url").val();y({ErrorMessage:"Error on FIGMA service",ErrorType:"Unable to connect or generic",SiteURL:l.siteUrl,wpVersion:l.wpVersion,pluginVersion:l.pluginVersion,figmaURL:t,figmaToken:l.figmaToken})},s.onclose=function(){}},r.connectWebSocketImageMerge=function(e,t){return n.apply(this,arguments)},r.connectWebSocketUserCheck=function(e){var t=l.checkUserIP,r=new WebSocket(t);r.onopen=function(){return r.send(JSON.stringify(e))},r.onmessage=function(e){e=JSON.parse(e.data);jQuery(".cnt-requests-be").text(e.credits);var t=new Date(e.expDate).toLocaleDateString("en-GB",{day:"2-digit",month:"long",year:"numeric"});jQuery(".cnt-renew-be").text(t),e.credits<=0&&((0,u.updateAppState)({hasKeys:!1}),(0,p.showAlert)("info",c.messages.alerts.noCreditsPlan,!1,c.messages.links.goToUpgrade.basic,c.messages.links.goToUpgrade.url,1))},r.onerror=function(e){r.close()},r.onclose=function(){return console.log("WebSocket is closed now.")}};var c=e("../messages/messages.js"),l=e("../utils/constants.js"),u=e("../state/appState.js"),g=e("./importFigma.js"),d=e("./handleFigmaStyles.js"),o=e("./publishPage.js"),p=e("../utils/components.js");function x(){x=function(){return i};var c,i={},e=Object.prototype,l=e.hasOwnProperty,u=Object.defineProperty||function(e,t,r){e[t]=r.value},t="function"==typeof Symbol?Symbol:{},n=t.iterator||"@@iterator",r=t.asyncIterator||"@@asyncIterator",o=t.toStringTag||"@@toStringTag";function a(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{a({},"")}catch(c){a=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var o,a,i,s,t=t&&t.prototype instanceof h?t:h,t=Object.create(t.prototype),n=new E(n||[]);return u(t,"_invoke",{value:(o=e,a=r,i=n,s=d,function(e,t){if(s===m)throw Error("Generator is already running");if(s===f){if("throw"===e)throw t;return{value:c,done:!0}}for(i.method=e,i.arg=t;;){var r=i.delegate;if(r){r=function e(t,r){var n=r.method,o=t.iterator[n];if(o===c)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=c,e(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;n=g(o,t.iterator,r.arg);if("throw"===n.type)return r.method="throw",r.arg=n.arg,r.delegate=null,y;o=n.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=c),r.delegate=null,y):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}(r,i);if(r){if(r===y)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(s===d)throw s=f,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s=m;r=g(o,a,i);if("normal"===r.type){if(s=i.done?f:p,r.arg===y)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(s=f,i.method="throw",i.arg=r.arg)}})}),t}function g(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}i.wrap=s;var d="suspendedStart",p="suspendedYield",m="executing",f="completed",y={};function h(){}function v(){}function j(){}var t={},w=(a(t,n,function(){return this}),Object.getPrototypeOf),w=w&&w(w(T([]))),b=(w&&w!==e&&l.call(w,n)&&(t=w),j.prototype=h.prototype=Object.create(t));function _(e){["next","throw","return"].forEach(function(t){a(e,t,function(e){return this._invoke(t,e)})})}function S(i,s){var t;u(this,"_invoke",{value:function(r,n){function e(){return new s(function(e,t){!function t(e,r,n,o){var a,e=g(i[e],i,r);if("throw"!==e.type)return(r=(a=e.arg).value)&&"object"==A(r)&&l.call(r,"__await")?s.resolve(r.__await).then(function(e){t("next",e,n,o)},function(e){t("throw",e,n,o)}):s.resolve(r).then(function(e){a.value=e,n(a)},function(e){return t("throw",e,n,o)});o(e.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}})}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function T(t){if(t||""===t){var r,e=t[n];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return r=-1,(e=function e(){for(;++r<t.length;)if(l.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=c,e.done=!0,e}).next=e}throw new TypeError(A(t)+" is not iterable")}return u(b,"constructor",{value:v.prototype=j,configurable:!0}),u(j,"constructor",{value:v,configurable:!0}),v.displayName=a(j,o,"GeneratorFunction"),i.isGeneratorFunction=function(e){e="function"==typeof e&&e.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,j):(e.__proto__=j,a(e,o,"GeneratorFunction")),e.prototype=Object.create(b),e},i.awrap=function(e){return{__await:e}},_(S.prototype),a(S.prototype,r,function(){return this}),i.AsyncIterator=S,i.async=function(e,t,r,n,o){void 0===o&&(o=Promise);var a=new S(s(e,t,r,n),o);return i.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},_(b),a(b,o,"Generator"),a(b,n,function(){return this}),a(b,"toString",function(){return"[object Generator]"}),i.keys=function(e){var t,r=Object(e),n=[];for(t in r)n.push(t);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},i.values=T,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=c,this.done=!1,this.delegate=null,this.method="next",this.arg=c,this.tryEntries.forEach(L),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=c)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return a.type="throw",a.arg=r,n.next=e,t&&(n.method="next",n.arg=c),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var o=this.tryEntries[t],a=o.completion;if("root"===o.tryLoc)return e("end");if(o.tryLoc<=this.prev){var i=l.call(o,"catchLoc"),s=l.call(o,"finallyLoc");if(i&&s){if(this.prev<o.catchLoc)return e(o.catchLoc,!0);if(this.prev<o.finallyLoc)return e(o.finallyLoc)}else if(i){if(this.prev<o.catchLoc)return e(o.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return e(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&l.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var a=(o=o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc?null:o)?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),L(r),y}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r,n,o=this.tryEntries[t];if(o.tryLoc===e)return"throw"===(r=o.completion).type&&(n=r.arg,L(o)),n}throw Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=c),y}},i}function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t,r,n,o,a,i){try{var s=e[a](i),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}function a(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function f(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=function(e){e=function(e,t){if("object"!=A(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=A(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==A(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function y(e){var t=l.errorLogIP,r=new WebSocket(t);r.onopen=function(){return r.send(JSON.stringify(e))},r.onmessage=function(e){r.close()},r.onerror=function(e){r.close()},r.onclose=function(){return console.log("WebSocket is closed now.")}}function n(){var s;return s=x().mark(function e(o,a){var i;return x().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=l.mergeIP,e.abrupt("return",new Promise(function(t,r){var n=new WebSocket(i);n.onopen=function(){n.send(JSON.stringify({images:o,sectionId:a}))},n.onmessage=function(e){e=JSON.parse(e.data);t(e),n.close()},n.onerror=function(e){console.error("WebSocket Error: ",e),r(e),n.close()},n.onclose=function(){return console.log("WebSocket is closed now.")}}));case 2:case"end":return e.stop()}},e)}),(n=function(){var e=this,i=arguments;return new Promise(function(t,r){var n=s.apply(e,i);function o(e){m(n,t,r,o,a,"next",e)}function a(e){m(n,t,r,o,a,"throw",e)}o(void 0)})}).apply(this,arguments)}},{"../messages/messages.js":2,"../state/appState.js":13,"../utils/components.js":16,"../utils/constants.js":17,"./handleFigmaStyles.js":6,"./importFigma.js":7,"./publishPage.js":9}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.appState=void 0,r.renderUIBasedOnState=l,r.updateAppState=function(e){r.appState=c=s(s({},c),e),l()};var n=e("../messages/messages.js"),o=e("../utils/components.js");function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function s(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?i(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],(e=function(e){e=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);r=r.call(e,t||"default");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string");return"symbol"==a(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):i(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}var c=r.appState={hasKeys:!0,hasDesktop:!1,hasMobile:!1,hasLP:!1,isLoading:!1};function l(){c.hasKeys||(jQuery(".lp-settings-form, .lp-sections-form, .nav-tabs, .lp-actions-bar").hide(),jQuery("#figma-desktop-form input, #figma-mobile-form input").prop("disabled",!0),jQuery("#figma-desktop-form .figma-error").css("display","block")),c.hasKeys&&!c.isLoading&&!c.hasDesktop&&jQuery(".illiant-page").length&&(0,o.showAlert)("info",n.messages.alerts.checkDocs,!1,n.messages.links.goToDocs.basicDocs,n.messages.links.goToDocs.url,1),c.isLoading?((0,o.hideAlerts)(),(c.loadBox?jQuery(".convert-box-"+c.loadBox+" .lp-loader-module"):jQuery(".lp-loader-module")).show()):jQuery(".lp-loader-module").hide()}window.addEventListener("beforeunload",function(e){if(!1!==c.isLoading&&0!==jQuery(".illiant-page").length)return e.preventDefault(),e.returnValue="You have unsaved changes. Are you sure you want to leave?",e.returnValue})},{"../messages/messages.js":2,"../utils/components.js":16}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.checkKeys=function(r,n){jQuery(function(e){var t=[];(jQuery("#requests").val()||"0")>=c.fReq&&"free"===n&&((0,a.updateAppState)({hasKeys:!1}),(0,i.showAlert)("info",o.messages.alerts.noCredits,!1,o.messages.links.goToUpgrade.basic,o.messages.links.goToUpgrade.url,1)),r||(t.push(o.messages.keys.figmaMissing),(0,a.updateAppState)({hasKeys:!1}),jQuery(".convert-ui").removeClass("active"),jQuery("#connectFigma").addClass("disabled"),(0,i.showAlert)("warning",o.messages.alerts.missingKeys,!1,o.messages.links.goToSettings.missingKeys,o.messages.links.goToSettings.url,1)),0===t.length&&(0,s.checkContent)()})};var o=e("../messages/messages.js"),a=e("./appState.js"),i=e("../utils/components.js"),s=e("./handleLayoutState.js"),c=e("../utils/constants.js")},{"../messages/messages.js":2,"../utils/components.js":16,"../utils/constants.js":17,"./appState.js":13,"./handleLayoutState.js":15}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.checkContent=function(){jQuery(function(e){var t=e("#figma_desktop_url").val(),e=e(".figma-frame-item.active");0<e.length&&e.data("node"),t.length&&(0,n.updateAppState)({hasDesktop:!0}),(0,n.updateAppState)()})};var n=e("./appState.js")},{"./appState.js":13}],16:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.activateResolutionSwitching=function(){document.querySelectorAll(".select-res-in > a, .select-res-full > a").forEach(function(e){return e.addEventListener("click",c)}),document.querySelector(".view-fullscreen").addEventListener("click",s),document.querySelector(".close-fullscreen").addEventListener("click",s)},r.activateTabs=function(){document.querySelectorAll("ul.nav-tabs > li").forEach(function(e){return e.addEventListener("click",a)}),document.querySelectorAll(".select-edit > a").forEach(function(e){return e.addEventListener("click",i)})},r.changeTabPreview=function(){var e=document.querySelector("ul.nav-tabs > li:nth-child(3)"),t=document.querySelector(e.querySelector("a").getAttribute("data-target"));document.querySelector("ul.nav-tabs li.active").classList.remove("active"),document.querySelector(".tab-pane.active").classList.remove("active"),e.classList.add("active"),t.classList.add("active"),jQuery("html, body").animate({scrollTop:250},"slow")},r.hideAlerts=function(){jQuery(function(e){e(".lp-alert").not(":first").remove()})},r.hideNotification=p,r.showAlert=function(n,o,a,i,s,c){jQuery(function(e){var t=e(".lp-alert").first().clone(),r=(t.addClass(n),o);switch(a&&(r+=" <strong>"+a+"</strong>"),e(".lp-message",t).html("<p>"+r+"</p>"),i&&e(".lp-link a",t).text(i).attr("href",s),e(".alert-close",t).off("click").one("click",function(){t.remove()}),c){case 1:case 2:case 3:t.insertBefore(".lp-import-form");break;default:console.log("Invalid location specified")}t.removeClass("hidden")})},r.showModal=function(n,o,a,i,s){var c=5<arguments.length&&void 0!==arguments[5]&&arguments[5],l=6<arguments.length&&void 0!==arguments[6]&&arguments[6],u=7<arguments.length&&void 0!==arguments[7]&&arguments[7];jQuery(function(e){var t=e(".lp-modal"),r=(t.addClass("show"),c&&t.addClass("large"),u&&t.addClass("hasImage"),e(".modal-ttl",t).text(n),e(".modal-body",t).html("<p>"+(Array.isArray(o)?o.join("<br>"):o)+"</p>"),e("#btn-confirm",t));r.off("click").hide(),a&&r.text(i).show().one("click",function(){t.removeClass("show"),"function"==typeof s&&s()}),e(".btn-close",t).off("click").one("click",function(){t.removeClass("show"),t.removeClass("large"),t.removeClass("hasImage"),l&&((0,g.updateAppState)({isLoading:!1}),d("warning","Conversion cancelled."),p())})})},r.showModalImage=function(t,o){jQuery(function(r){"string"==typeof o&&o.includes("http")&&(o=o.split(","));var e=r(".lp-modal-images"),n=(e.addClass("show"),r(".modal-ttl",e).text(t+" section images"),r(".modal-body",e));n.empty(),o.forEach(function(e){var t=r("<div>").addClass("modal-img-wrapper"),e=r("<img>").attr("src",e);t.append(e),n.append(t)}),r(".btn-close",e).off("click").one("click",function(){e.removeClass("show")})})},r.showNotification=d,r.updateNotification=function(r){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;jQuery(function(e){var t=e(".lp-not");e(".lp-not-message",t).text(r),null!==n&&null!==o&&(e(".curr",t).text(n),e(".tot",t).text(o))})};var n=e("./utils.js"),o=e("./constants.js"),g=e("../state/appState.js");function d(r,n){var o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;jQuery(function(e){var t=e(".lp-not");t.removeClass("success warning info"),t.addClass(r),e(".lp-counter").show(),"info"===r&&null!==a?(e(".curr",t).text(o),e(".tot",t).text(a)):e(".lp-counter").hide(),e(".lp-not-message",t).text(n),t.addClass("active")})}function p(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1200,r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1500;jQuery(function(e){setTimeout(function(){e(".lp-not").removeClass("active")},t),setTimeout(function(){e(".lp-not").removeClass("success warning info")},r)})}function a(e){var t=e.currentTarget;t.classList.contains("disabled")?e.preventDefault():((0,n.stopCheckCodeChanges)(),document.querySelector("ul.nav-tabs li.active").classList.remove("active"),document.querySelector(".tab-pane.active").classList.remove("active"),e=t.querySelector("a").getAttribute("data-target"),t.classList.add("active"),document.querySelector(e).classList.add("active"))}function i(e){var t,r=e.currentTarget;r.classList.contains("disabled")?e.preventDefault():(e=document.querySelector(".select-edit a.active"),t=document.querySelector(".subtab-pane.active"),e&&e.classList.remove("active"),t&&t.classList.remove("active"),e=r.getAttribute("data-target"),r.classList.add("active"),t=e.startsWith("#")?"":"#",r=document.querySelector(t+e),"edit-html"===e?(jQuery("#save_edited_code").show(),(0,n.stopCheckCodeChanges)(),(0,n.checkCodeChanges)(o.htmlEditor)):"edit-css"===e?(jQuery("#save_edited_code").show(),(0,n.stopCheckCodeChanges)(),(0,n.checkCodeChanges)(o.cssEditor)):(jQuery("#save_edited_code").hide(),(0,n.stopCheckCodeChanges)()),r&&r.classList.add("active"))}function s(e){var t=document.body.classList.toggle("isFullscreen"),r=(jQuery(".iframe-controls").toggle(t),document.querySelector(".lp-preview-wrapper").classList.toggle("fullscreen",t),document.querySelector(t?".select-res > a.active:last-child":".select-res-full > a.active:last-child"));r&&(document.querySelector(t?".select-res > a:first-child":".select-res-full > a:first-child").classList.add("active"),r.classList.remove("active")),document.querySelector("#lp-preview").classList.remove("mobile","desktop")}function c(e){var e=e.currentTarget,t=document.body.classList.contains("isFullscreen")?".select-res-full > a":".select-res-in > a",t=document.querySelector(t+".active"),t=(t&&t.classList.remove("active"),e.classList.add("active"),e.getAttribute("data-target"));document.querySelector("#lp-preview").classList.remove("mobile","desktop"),document.querySelector("#lp-preview").classList.add(t)}},{"../state/appState.js":13,"./constants.js":17,"./utils.js":18}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.wpVersion=r.systemFonts=r.siteUrl=r.pluginVersion=r.mergeIP=r.licenseId=r.importDesignIP=r.figmaToken=r.figmaId=r.fReq=r.expiration=r.errorLogIP=r.currentPlan=r.created=r.convertIP=r.checkUserIP=r.__=void 0;var n=wp.i18n;r.__=n.__,n._x,n._n,n.sprintf,r.figmaToken=jQuery("#figma_access_token").val(),r.figmaId=jQuery("#figma_id").val(),r.fReq=50,r.currentPlan=jQuery("#planName").val(),r.licenseId=jQuery("#licenseId").val(),r.expiration=jQuery("#expiration").val(),r.created=jQuery("#created").val(),r.siteUrl=window.location.href,r.wpVersion=illiantscriptsData.wpVersion,r.pluginVersion="2.4.1",r.importDesignIP="wss://api.illiant.ai/import-design",r.checkUserIP="wss://api.illiant.ai/check-user",r.errorLogIP="wss://api.illiant.ai/error-log",r.convertIP="wss://api.illiant.ai/convert",r.mergeIP="wss://api.illiant.ai/merge",r.systemFonts=["Arial","Helvetica","Sans-Serif","Arial Black","Gadget","Comic Sans MS","Textile","Cursive","Courier New","Courier","Monospace","Georgia","Times New Roman","Times","Impact","Charcoal","Lucida Console","Monaco","Lucida Sans Unicode","Lucida Grande","Palatino Linotype","Book Antiqua","Palatino","Tahoma","Trebuchet MS","Verdana","Geneva","MS Sans Serif","MS Serif","New York","Serif"]},{}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.findImageFillNodes=function(e,t,r){var n;return e.length&&(e=e[0].html,e=(new DOMParser).parseFromString(e,"text/html").querySelectorAll("[data-ref]"),n=new Set(r.map(function(e){return e.imageRef})),e.forEach(function(e){e=e.getAttribute("data-ref");e&&t[e]&&!n.has(e)&&(r.push({imageUrl:t[e],imageRef:e}),n.add(e))})),r},r.findImageNodes=function(e,t){if(!e.length)return t;for(var e=e[0].html,e=(new DOMParser).parseFromString(e,"text/html"),r=new Set(t),n=e.querySelectorAll("[data-node]"),o=0;o<n.length;o++){var a=n[o].getAttribute("data-node");a&&r.add({nodeId:a,isMultiNode:!1,isMultiImage:!1,canvasData:null,boundingData:null})}for(var i=e.querySelectorAll("[data-multinode]"),s=0;s<i.length;s++){var c=i[s].getAttribute("data-multinode");c&&r.add({nodeId:c,isMultiNode:!0,isMultiImage:!1,canvasData:null,boundingData:null})}for(var l=e.querySelectorAll("[data-multi]"),u=0;u<l.length;u++){var g=l[u],d=g.getAttribute("data-multi"),p=g.getAttribute("data-canvas"),g=g.getAttribute("data-bounding");if(d&&p){var m,d=d.split(",");try{p.startsWith("[")&&p.endsWith("]")?(m=JSON.parse(p),r.add({nodeId:d,isMultiNode:!1,isMultiImage:!0,canvasData:m,boundingData:g})):console.error("Invalid canvasData format:",p)}catch(e){console.error("Error parsing canvasData JSON:",e)}}}return Array.from(r)},r.generateRandomId=function(){return"page-"+Math.floor(1e7+9e7*Math.random())}},{}]},{},[1]);
//# sourceMappingURL=illiantscripts.min.js.map
